{{/*
  SoundCloud consent-aware embed shortcode
  
  Usage: {{< soundcloud "https://soundcloud.com/icetribe/track-name" >}}
  
  Shows consent notice if analytics cookies not accepted,
  otherwise shows the SoundCloud player.
*/}}

{{ $url := .Get 0 }}
{{ $trackId := "" }}

{{/* Extract track ID from URL for embed */}}
{{ if $url }}
  {{ $parts := split $url "/" }}
  {{ if ge (len $parts) 2 }}
    {{ $trackId = index $parts (sub (len $parts) 1) }}
  {{ end }}
{{ end }}

<div class="soundcloud-embed">
  <div class="soundcloud-consent-notice" style="border: 2px solid #8A42A8; border-radius: 8px; padding: 20px; margin: 20px 0; background-color: #f9f9f9; text-align: center;">
    <h4 style="color: #8A42A8; margin-top: 0;">üéµ SoundCloud-soitin</h4>
    <p>SoundCloud-soittimet kuuluvat analytiikka-ev√§steisiin. Hyv√§ksy analytiikka-ev√§steet kuullaksesi esimerkkej√§ musiikistamme.</p>
    <button onclick="enableAnalyticsAndSoundCloud()" style="background-color: #8A42A8; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-size: 16px;">
      Hyv√§ksy analytiikka-ev√§steet
    </button>
    <p style="font-size: 12px; color: #666; margin-bottom: 0;">
      Voit my√∂s muuttaa ev√§steasetuksia sivun alareunasta.
    </p>
  </div>

  <div class="soundcloud-player" style="display: none;">
    {{ if $url }}
      <iframe width="100%" height="300" scrolling="no" frameborder="no" allow="autoplay"
              src="https://w.soundcloud.com/player/?url={{ $url | urlquery }}&color=%23ff5500&auto_play=false&hide_related=false&show_comments=true&show_user=true&show_reposts=false&show_teaser=true&visual=true">
      </iframe>
    {{ end }}
  </div>
</div>